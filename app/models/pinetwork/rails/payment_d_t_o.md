A PaymentDTO from the Pi Network Server is a hash with the following structure
```
{
  // Payment data:
  identifier: string; // payment identifier
  user_uid: string; // user's app-specific ID
  amount: number; // payment amount
  memo: string; // a string provided by the developer, shown to the user
  metadata: Object; // an object provided by the developer for their own usage
  from_address: string; // sender address of the blockchain transaction
  to_address: string; // recipient address of the blockchain transaction
  direction: Direction; // direction of the payment
  created_at: string; // payment's creation timestamp in ISO8601 format
  network: AppNetwork; // a network of the payment

  // Status flags representing the current state of this payment
  status: {
    developer_approved: boolean; // Server-Side Approval
    transaction_verified: boolean; // blockchain transaction verified
    developer_completed: boolean; // server-Side Completion
    cancelled: boolean; // cancelled by the developer or by Pi Network
    user_cancelled: boolean; // cancelled by the user
  };

  // Blockchain transaction data:
  transaction: null | {
    // This is null if no transaction has been made yet
    txid: string; // id of the blockchain transaction
    verified: boolean; // true if the transaction matches the payment, false otherwise
    _link: string; // a link to the operation on the Blockchain API
  };
};
type Direction = "user_to_app" | "app_to_user"; // treat these as symbols
type AppNetwork = "Pi Network" | "Pi Testnet"; // treat these as strings
```

The PaymentDTO class encapsulates this hash with standard Ruby access methods. All strings should be UTF-8 encoded; timestamps are always UTC. All fields should be present. The constructor
should be able to handle a hash generated by JSON.parse of the text serialization that is
sent via http.

## API and Error Handling
- The `.get(payment_id)` method performs a GET to Pi's `/v2/payments/{payment_id}` endpoint.
- If the API call fails (HTTP error, invalid token, network error, parsing error): it returns `nil` and **never raises an exception** for normal user code.
- All transient errors and API errors result in `nil`; if debug/tracing is needed, see warnings to stderr (suppressible in tests via RSpec, see model spec).

## Preferred Date Parsing
- When calling `valid_until`, the preferred value is `iso8601` (parsed via `DateTime.iso8601`).
- If `iso8601` is missing or empty, will fall back to parsing `timestamp` as UTC (`DateTime.strptime(ts, '%s')`).
- If both are absent or invalid, `valid_until` returns nil.
- All date/times are assumed UTC; if the API stops supplying Z timezone in iso8601, verify any parsing changes.

## DTO Attributes
Use the provided hash keys as attributes.

## Testing/Updates
- Canonical spec for test data is found at `spec/models/pinetwork/rails/payment_d_t_o_spec.rb`.
- If the Pi API changes structure or adds keys, update this file and spec accordingly.

## Output and Test Practices
- All warnings printed to stderr during .get internal errors can and should be suppressed in test suites using RSpec's `allow(described_class).to receive(:warn)` or similar block.

## Usage Example (IRB/Console)
```ruby
# Fetching
payment = Pinetwork::Rails::PaymentDTO.get("PAYMENT_ID")
if payment
  puts payment.inspect
else
  puts "Payment id not valid or API error"
end
```

## Note
- This markdown file serves as the canonical developer spec for PaymentDTO value objects in pinetwork-rails. Developers should refer here when updating DTO logic or specs.
